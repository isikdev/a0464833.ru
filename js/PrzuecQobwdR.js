var bd=function(){function t(){this.watch={touch:function(){this.scroll||this.mouse||this.set("human",!0)},mouse:function(){this.mobile||this.touch||this.set("human",!0)},human:function(){this.initHuman()},user_id:function(){localStorage.setItem("human.user_id",this.user_id)}},this.coords=[],this.user_id=localStorage.getItem("human.user_id")?localStorage.getItem("human.user_id"):null,this.id=null,this.human=!1,this.mobile=!1,this.touch=!1,this.mouse=!1,this.scroll=!1,this.socket=null,this.socketReady=!1,this.wsReady=!1,this.initEvents(),this.initUser(),this.initSocket()}return t.prototype.set=function(t,e){this[t]!=e&&(this[t]=e,t in this.watch&&this.watch[t].call(this))},t.prototype.api=function(t,e){void 0===e&&(e=!1);var i=this,n=new XMLHttpRequest;n.open("POST","https://server.seovolga.ru/human",!0),n.responseType="json",n.send(t),n.addEventListener("load",(function(t){var n=t.target.response;for(var o in n)o in i&&i.set(o,n[o]);e&&e(n)}))},t.prototype.initEvents=function(){this.initTouch(),this.initMouse(),this.initScroll()},t.prototype.initUser=function(){var t=new FormData;t.set("type","initUser"),t.set("User[screen]",window.screen.width+"x"+window.screen.height),t.set("User[url]",location.href),t.set("user_id",this.user_id),this.api(t)},t.prototype.initSocket=function(){try{var t=this;this.socket=new WebSocket("wss://server.seovolga.ru:8888"),this.socket.addEventListener("message",(function(e){t.wsReady=!0})),this.socket.addEventListener("open",(function(e){t.set("socketReady",!0)}));["error","close"].forEach((function(e){t.socket.addEventListener(e,(function(){t.set("socketReady",!1),"close"==e&&setTimeout((function(){t.initSocket()}),1e3)}))}))}catch(e){t.set("socketReady",!1)}},t.prototype.initMobile=function(){var t=navigator.maxTouchPoints||"ontouchstart"in document.documentElement;(window.innerWidth<window.innerHeight||t)&&(this.mobile=!0)},t.prototype.initTouch=function(){var t=this;["touchstart"].forEach((function(e){window.addEventListener(e,(function(e){e.isTrusted&&!t.human&&t.set("touch",!0)}),!1)}))},t.prototype.initMouse=function(){var t=this;window.addEventListener("mousemove",(function(e){if(e.isTrusted&&!t.human){t.coords.push({x:e.screenX,y:e.screenY});var i=0;if(t.coords.length>20){for(var n in t.coords){var o=t.coords[n];if("object"==typeof t.coords[n-1]){var s=t.coords[n-1];if(Number(o.x)==Number(s.x)||Number(o.y)==Number(s.y))continue;i+=Math.abs(Number(o.x)-Number(s.x))+Math.abs(Number(o.y)-Number(s.y))}}t.coords=[]}i>=20&&t.set("mouse",!0)}}),!1)},t.prototype.initScroll=function(){var t=this;window.addEventListener("scroll",(function(e){e.isTrusted&&!t.human&&t.set("scroll",!0)}),!1)},t.prototype.initHuman=function(){var t=this;if(this.id){var e=new FormData;e.set("type","setHuman"),e.set("id",this.id),this.api(e),this.initDocumentEvent(),document.addEventListener("DOMContentLoaded",(function(){t.initDocumentEvent()}))}else setTimeout((function(){t.initHuman()}),50)},t.prototype.initDocumentEvent=function(){var t=new CustomEvent("humanAccepted",{detail:this.user_id});document.dispatchEvent(t)},t.prototype.getObjInEvent=function(t){var e={};for(var i in t){var n=t[i];~["object","function"].indexOf(typeof n)||(e[i]=n)}return e},t}();new bd;